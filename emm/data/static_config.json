{
    "nubomedia": {
        "connector": {
            "name": "connector",
            "image": "nubomedia-control-server",
            "port_enable": true,
            "floating_ip_enable": true,
            "user_data": {
                "template":  
                    "#!/bin/bash -v\nsudo sed -i \"s/^\\(kmf.transport[ \\t]*\\)=thrift/\\1 = rabbitmq/\" /etc/kurento/media-connector.properties\nsudo sed -i \"\\$arabbitmq.address=$BROKER_IP:5672\" /etc/kurento/media-connector.properties\nsudo service kmf-media-connector restart",
                "params":{"$BROKER_IP": {"get_attr": ["broker", "first_address"]}}}
        },
        "broker": {
            "name": "broker",
            "image": "nubomedia-broker",
            "port_enable": true,
            "floating_ip_enable": false,
            "user_data":{}
        },
        "media_server_group": {
            "name": "media_server_group",
            "image": "nubomedia-media-server",
            "policies": {
                "alarm":{
                    "evaluation_periods": 1,
                    "repeat_actions": true
                }
            },
            "user_data": {
                "template": 
                    "#!/bin/bash -v\nsudo sed -i \"s/^\\(serverAddress[ \\t]*\\)=[ \\t]*[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*.*$/\\1 = $BROKER_IP/\" /etc/kurento/kurento.conf",
                "params": {
                    "$BROKER_IP": {"get_attr": ["broker", "first_address"] }
                }
            }
        },
        "security_group": {
            "name": "security_group",
            "rules": [
                {
                    "name": "rule_icmp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "icmp"
                },
                {
                    "name": "rule_tcp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "tcp",
                    "port_range_max": "22",
                    "port_range_min": "22"
                }
            ]
        }
    }
}
