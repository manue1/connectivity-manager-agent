{
    "nubomedia": {
        "connector": {
            "name": "control_server",
            "image": "nubomedia-control-server",
            "port_enable": true,
            "floating_ip_enable": true,
            "user_data": {
                "template":  
                    "#!/bin/bash -v \n sudo sed \"s/^\([ \t]*\"address\"[ \t]*\):[ \t]\"*[0-9]*\.[0-9]*\.[0-9]*\.[0-9]\"*.*$/\1: \"$BROKER_IP\"/\" /etc/kurento/kurento.conf.json \nsudo /etc/init.d/kurento-control-server restart \nnohup mvn -f /opt/kurento-tutorial-java/kurento-hello-world/pom.xml compile exec:java -Dserver.port=8081 & \n nohup mvn -f /opt/kurento-tutorial-java/kurento-magic-mirror/pom.xml compile exec:java -Dserver.port=8082 & \n nohup mvn -f /opt/kurento-tutorial-java/kurento-one2many-call/pom.xml compile exec:java -Dserver.port=8083 & \nnohup mvn -f /opt/kurento-tutorial-java/kurento-one2one-call/pom.xml compile exec:java -Dserver.port=8084 &",
                "params":{"$BROKER_IP": {"get_attr": ["broker", "first_address"]}}}
        },
        "broker": {
            "name": "broker",
            "image": "nubomedia-broker",
            "port_enable": true,
            "floating_ip_enable": false,
            "user_data":{}
        },
        "media_server_group": {
            "name": "media_server_group",
            "image": "nubomedia-media-server",
            "floating_ip_enable": true,
            "policies": {
                "alarm":{
                    "evaluation_periods": 1,
                    "repeat_actions": true
                }
            },
            "user_data": {
                "template": 
                    "#!/bin/bash -v\n cp /etc/kurento/kurento-broker.conf.json /etc/kurento/kurento.conf.json\nsudo sed -i \"s/^\\([ \\t]*\\\"address\\\"[ \\t]*\\):[ \\t]\\\"*[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]\\\"*.*$/\\1: \\\"$BROKER_IP\\\"/\" /etc/kurento/kurento.conf.json\nsudo /etc/init.d/kurento-media-server restart",
                "params": {
                    "$BROKER_IP": {"get_attr": ["broker", "first_address"] }
                }
            }
        },
        "security_group": {
            "name": "security_group",
            "rules": [
                {
                    "name": "rule_icmp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "icmp"
                },
                {
                    "name": "rule_tcp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "tcp",
                    "port_range_max": "0",
                    "port_range_min": "65536"
                },
                {
                    "name": "rule_udp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "udp",
                    "port_range_max": "0",
                    "port_range_min": "65536"
                }
            ]
        }
    }
}
