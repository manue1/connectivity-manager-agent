{
    "nubomedia": {
        "connector": {
            "name": "control_server",
            "image": "nubomedia-control-server",
            "port_enable": true,
            "floating_ip_enable": true,
            "user_data": {
                "template":
                    "#!/bin/bash -v \nHOST_NAME=$(cat /etc/hostname) \nsudo sed -i \"s/^\\([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*[ \\t]*localhost\\)/\\1 $HOST_NAME/\" /etc/hosts \nsudo sed -i \"s/^\\([ \\t]*\\\"address\\\"[ \\t]*\\):[ \\t]*\\\"Broker private IP Address\\\"*.*$/\\1: \\\"$BROKER_IP\\\",/\" /etc/kurento/kurento.conf.json \n#sudo sed -i \"s/^\\([ \\t]*\\\"address\\\"[ \\t]*\\):[ \\t]\\\"*[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]\\\"*.*$/\\1: \\\"$BROKER_IP\\\",/\" /etc/kurento/kurento.conf.json \nsudo service kurento-control-server restart \nscreen -m -d -S 8081 mvn -X -f /opt/kurento-tutorial-java/kurento-hello-world/pom.xml compile exec:java -Dserver.port=8081 -Djava.security.egd=file:/dev/./urandom \nscreen -m -d -S 8082 mvn -X -f /opt/kurento-tutorial-java/kurento-magic-mirror/pom.xml compile exec:java -Dserver.port=8082 -Djava.security.egd=file:/dev/./urandom \nscreen -m -d -S 8083 mvn -X -f /opt/kurento-tutorial-java/kurento-one2many-call/pom.xml compile exec:java -Dserver.port=8083 -Djava.security.egd=file:/dev/./urandom \nscreen -m -d -S 8084 mvn -X -f /opt/kurento-tutorial-java/kurento-one2one-call/pom.xml compile exec:java -Dserver.port=8084 -Djava.security.egd=file:/dev/./urandom",
                "params":{"$BROKER_IP": {"get_attr": ["broker", "first_address"]}}}
        },
        "broker": {
            "name": "broker",
            "image": "nubomedia-broker",
            "port_enable": true,
            "floating_ip_enable": false,
            "user_data":{
                "template":
                    "#!/bin/bash -v \nHOST_NAME=$(cat /etc/hostname) \nsudo sed -i \"s/^\\([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*[ \\t]*localhost\\)/\\1 $HOST_NAME/\" /etc/hosts",
                "params": {
                    "\"\"":"\"\""
                }
            }
        },
        "media_server_group": {
            "group_name": "media_server_group",
            "instance_name": "Media Server",
            "image": "nubomedia-media-server",
            "floating_ip_enable": true,
            "policies": {
                "alarm":{
                    "evaluation_periods": 1,
                    "repeat_actions": true
                }
            },
            "user_data": {
                "template": 
                    "#!/bin/bash -v \nHOST_NAME=$(cat /etc/hostname) \nsudo sed -i \"s/^\\([0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]*[ \\t]*localhost\\)/\\1 $HOST_NAME/\" /etc/hosts \ncp /etc/kurento/kurento-broker.conf.json /etc/kurento/kurento.conf.json \nsudo sed -i \"s/^\\([ \\t]*\\\"address\\\"[ \\t]*\\):[ \\t]*.*[0-9]*\\.[0-9]*\\.[0-9]*\\.[0-9]\\\"*.*$/\\1: \\\"$BROKER_IP\\\",/\" /etc/kurento/kurento.conf.json \nsudo service kurento-media-server restart",
                "params": {
                    "$BROKER_IP": {"get_attr": ["broker", "first_address"] }
                }
            }
        },
        "security_group": {
            "name": "security_group",
            "rules": [
                {
                    "name": "rule_icmp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "icmp"
                },
                {
                    "name": "rule_tcp_22",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "tcp",
                    "port_range_min": "22",
                    "port_range_max": "22"
                },
                {
                    "name": "rule_tcp_8888",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "tcp",
                    "port_range_min": "8888",
                    "port_range_max": "8888"
                },
                {
                    "name": "rule_tcp_8080-8090",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "tcp",
                    "port_range_min": "8080",
                    "port_range_max": "8090"
                },
                {
                    "name": "rule_udp",
                    "remote_ip_prefix": "0.0.0.0/0",
                    "protocol": "udp",
                    "port_range_min": "1024",
                    "port_range_max": "65535"
                }
            ]
        }
    }
}
